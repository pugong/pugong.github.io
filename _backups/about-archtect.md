首先，讨论这个问题要先明确几个前提，前提不认可的话要先讨论前提是否正确了

前提1: 数据库访问必须使用连接池，连接池里面的数据库连接都是长连接。因为建立连接是一个耗时较长的操作，频繁关闭新建连接会很大影响应用的性能，因此建议长连接的时间尽可能长
前提2: 从应用到数据库的长连接中间有很多节点，数据库和网络节点中的路由和LB都有长连接超过时长断开的机制，因此连接池的长连接不能太长，需要略小于数据库或网络设备所允许的长连接最大值，避免被数据库服务器或者网络设备将连接断开

总结前两点：连接需要复用，这个复用的时长略小于数据库或网络设备所允许的时长即可。因此研发管理部的建议没有问题。

而现实中这两个数据都远超30分钟，要不然配置30分钟复用的应用在此之前就会有很多异常。我们可以先找dba要一下数据库的最大时长。

而根据这次uioc后续的分析，如果主备切换后原来的主机可以发出断开连接的信息（关数据库/关服务器/拔网线等），应用的数据库连接被断开后新建是走马上走新连路连到新服务器上的，不需要等到复用最大时间。而如果原主机的数据库端口如果可以正常工作，没有断开的

-------

补充一下这次事件后的验证过程：
uioc当天，在DBA和主机同事的配合下，在测试环境验证了数据库服务器各种故障下（关DB，杀DB进程等），应用在数据库恢复后都可以正常连接上数据库。由于不能快速在测试环境搭建和生产环境类似的主备环境，所以第二天在测试环境申请一个VIP和两台服务器做个简化版的主备切换，在两台服务器分别安装PG数据库，分别标识为PGA，PGB，初始状态VIP指向PGA。实验的链路如下：
JMeter --> APP --> VIP --> PGA

实验过程如下
场景一：将连接池连接复用时间缩短到5分钟，启动应用。确认应用正常运行后，切换VIP到PGB，可以观察到过一段时间后应用全部切换到PGB。
场景二：恢复应用配置调整为和生产一致，在应用正常启动后，重新将VIP切换回PGA，观察到20多分钟的时候切换回PGA。
场景三：再次将VIP切换到PGB，切换后比场景二多做了一个操作：将PGA的数据实例关闭。PGA关闭后观察到应用的数据库连接并没有等待而是马上全部切换到了PGB

大家可以重复上述实验，看我们的实验的流程是否有遗漏的地方。

-----

近期参加了一个由于数据库主备切换引发的UIOC讨论，感觉中间有两个可以改进的地方：
1. 缺少Blameless Postmortem的氛围，UIOC讨论中并不是所有人都在摆事实讲道理，找出问题根因，而是争辩，发表各自观点。是否可以提议至少在钟总系列里面培养Blameless Postmortem的文化
   
2. 有团队领导在uioc会议上不断重申“上层应用要兼容下层”的观点，这个观点在技术公司提是否有点不合适，之前工作的公司的架构团队+框架团队和运维团队会一起合作，尽量不把这些复杂性暴露给业务团队，让业务研发团队关注在业务开发中而不需要去考虑如何兼容运维中可能出现的各种故障。而且我们也对外提供云平台，如果我们是这种态度客户怎么能信任我们，而且外面头部的云团队都已经宣传可以无感迁移到他们平台上，而我们还要应用兼容我们主机的运维。感觉也是这种思路导致研发管理，安全以及运维都会发很多文要求业务开发团队去做各种自检和兼容工作。因此是否可以提倡各自团队尽量不要把把复杂度暴露给外面，如果不得不暴露也尽量提供工具辅助业务团队完成检视/改造工作

不知道提议是否合适，还请各位老板帮忙评估判断