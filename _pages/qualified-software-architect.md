


Ctrip业务正在快速增长，团队规模也在跟着快速的增长，当然技术也跟着在更新。在这个关键的时期，互联网企业的架构师们，需要提高如下几方面的技能，才能更好的应对这些挑战:
第一点：在问题发生之前解决问题
当问题发生才去解决，往往这个时候已经比较晚了，很被动。提前一步解决问题，可以为我们赢得更多的时间，掌握变化的主动权。这是一个比较高且难的要求。携程非常需要这样的架构师：问题要能提前看到，并提前给出解决方案。希望大家能去思考：今天有哪些问题还没有真正发生，但我已经发现了？架构师应该能够提出来并想办法推动去解决掉！
列举一下携程的案例：2013年，在ESB里connection到了瓶颈，连写这个代码的人都不知道，这个问题严重到把整个网站都拖垮了。为什么整个网站都跑不起来？因为我们所有的应用相互访问都需要通过ESB传输数据，形成了一个单点问题。这么严重的问题，没有人提前看到了，直到问题发生大家才被迫不得不处理这个问题。同样的问题后来还发生了一次。
架构师平时需要有一个锻炼：去感觉问题。就像去闻变质食物，马上能闻到味道不对。如果等吃了以后拉肚子才知道食物有问题，那就太晚了，我们需要做到没吃就能闻到问题。一般来说，99%的问题是先冒烟后着火。当冒烟时你的“鼻子”就应该能闻出来。比如我们的流量在五一、十一等高峰期，你要去看有没有冒烟？肯定会有的，所以你的“鼻子”一定要灵，才能提前发现问题。
第二点：实施解决方案时，架构师和工程师要各取所长
工程师有时候会识别不出来问题，架构师应该帮忙指出来。工程师会更关注实现的细节，确保代码的质量。而架构师的主要精力在系统级别、跨应用的问题，会更少的关注应用内部、模块的问题。携程在这方面做的不好，架构师和工程师之间的互补性没有体现出来。架构师有的时候做了工程师的事情，工程师有的时候会挑战架构师。分工不明确产生了一系列问题。这里举几个例子：有的应用，架构师和工程师耦合起来，事实上可以不要耦合，不要“连体婴儿”，但现在“连体婴儿”的事情每周都在发生，要尽早尽快尽多地解开。
分工不明确，就会导致架构师做出不正确的判断。比如，如果总是站在应用内部而不是跨应用的层面上，架构师容易重复造轮子。工程师看一个地方的时候，没有看到其他的地方，他会造一个轮子，他不知道别的地方已经有轮子。但是作为架构师，他能看到跨系统的话，他就知道这个地方我们是这样解决的，就知道重用。比如说，如果每一个团队都自己做一个缓存，会是什么样？那携程的缓存就会满天飞，并且每个缓存的水平都不一样，那每个地方出一个问题，如果是10个缓存，那就出10个问题，如果1个地方出10问题，那就有100个问题，那就要100个地方需要解决，重复劳动会消耗很多资源。作为架构师，就要避免重复造轮子；而工程师由于要提交高质量的交付，压力比较大，因此不能花很多精力在设计上。工程师和架构师之间应该是各取所长的，架构师应该帮助工程师指出来设计上的问题。，如果没有这种互补性，那架构师的作用会很有限。
架构师花很长时间写代码，没有错，架构师应该要有写代码的能力。但是在写代码的时候，你起的是工程师的作用，而不是架构师的作用。一个好的架构师，可以管住50个开发人员。50个人每天、每周在做什么，他从设计角度看，都可以管得住，除了很细节的代码层面的问题外，应用和应用之间应该是可以管得住的。比如，前两天我碰到一个问题，支付怎么和各个业务之间交流？设计出来的方案五花八门，就闲的没事老要“握手”，支付和业务之间不停的“握手”，“握手”次数越多，出的问题越多。能不能做的仅一次“握手”，支付和业务就搞定？这时架构师应该站出来，把问题理清楚。携程在这方面做的还是远远不够，工程师和架构师之间的互补性没有体现出来。
这里还有一个例子，也是系统性的问题，FAT和UAT的建设。没有这两系统会影响整个研发团队的效率。FAT是需要设计的，这个FAT是什么样子？现在50套，以后100套、200套是什么样子？设计出来的架构应该是可以横向扩展的。比如酒店现在10套不够，那再加10套，只要把机器放进去就可以。设计的架构能不能支持这个？这里面有很多系统性的东西要做，我们搭出来的系统必须是扩展的。最近FAT里面加了很多无线的测试。架构上支持不仅Web能测，无线也能测。类似这样的东西，架构师需要去思考。因为开发人员是不会去思考这些东西的，这也不是他的主要职责。作为架构师的你，如果能够这样去思考，把这些问题解决好，需要我来介入并解决的问题就会大大减少，这样大家的效率就会大大提高。
第三点：架构一定要简单，并能解决业务问题。
架构师必须具备设计简单方案来解决问题的能力。如果发现解决方案很复杂，说明并没有真正理解业务的本质，要进一步深入，直到找到简单的解决方案为止。要做到这点，需要在架构简单和业务需求上保持平衡。有好几个方案到我手上，都是异步和同步搞错了。直到今天，携程网站上还有很多异步和同步问题搞错了。比如火车票，订单下去，老是显示不出下的订单来。当我收到手机短信通知，告诉我已经出票了。但当我登陆到系统中，却发现订单状态显示的是出票中。再到行程单去看，有一张票已经显示出来了，但是点击进去，这个票又是找不到的。这个问题看起来很可笑，用户体验很差。如果是同步的话，订单状态就不会出错。大家都没有发现这个问题。系统里面同步和异步使用肯定是有问题的。举这个例子，是想说明要保持架构的简单。给大家一个作业，大家到你所负责的领域去“扫一扫”，能不能扫出一些问题来，并让架构更简单。
第四点：设计需要做到可横向扩展。
架构师常犯的错误：设计只是短期管用，超过六个月，必须要改设计才能满足新的需求。在这个状态下，设计师会浪费大量的精力更新架构文档，做重复的工作。如果你知道这个设计只管今天不管明天，那应该有理由，为什么只管今天。我就担心一个设计出来，不知道明天行不行。比如你造了一座桥，今天一辆车子开过去是可以的，明天开了一辆重一点的车，“砰”就掉下去了。作为桥梁的架构师，却不知道会不会有车掉下去是不可思议的。
关于短期和长期的设计，当然长期设计会比较好。如果因为一些原因，你做了一个短期的设计或者项目，别人问几个问题，要能够经得起推敲。如果你能考虑详细周全，短期项目也可以。还有一个问题，就是可扩展性。一个架构做出来可以很简单，但是你要知道这个架构到了什么程度会承受不了，承受不了时是否可以扩展。如果说设计不可扩展，到了加机器都没用的时候，就如病入膏肓，无药可救了。所以，架构师要考虑这些问题。
前段时间有一个风控的架构，架构师说要做sharding。架构师都喜欢做sharding，架构师提到做sharding就很激动，但做sharding维护成本很高的。架构师出了一个方案，真正实施的话，运营、开发要做很多工作来帮你实现这个方案，开销多了不少。刚开始，方案可以很简单，但是这个简单的方案应该是可扩的，比如现在这个方案可以维持两倍的流量，等到流量到了50%时，再一分为二，这样可以维持四倍，这时还可以挺三倍的流量。等到了四倍的流量，再一分为二，这样就变八倍了。八倍还可以继续往前等等。sharding可以不用一开始就做，不需要一出来就是扩好的方案。比如出一个10年后都可用的方案，这意味着，9年的资源现在就浪费掉了！所以大家一定要想到这个。
第五点：架构师要有还债的意识。
其实我们都有债，每个地方都会有债，如果没有债的话，那大家的价值就不大了，很多时候我们都在还债。作为架构师，我们应该有这样的意识：哪个地方过去做的不够好，我们可以在哪些地方提高？架构师每天花点时间来做这个锻炼的话，感觉会越来越强烈。架构师要提出这些问题，哪怕提出问题和解决方案HOD没有采纳，这是HOD的问题。但是不提问题、不提供解决方案就是架构师的问题。
最后一点：要成为平衡短期实现和长期解决方案的专家。
这个要变成架构师的DNA。当被问到长期的解决方案的时候，经常发现架构师并没有思考这个问题。刚才我讲到一个设计要有可扩展性，可扩性里面和长短期也有关系。比如，10年的解决方案需不需要现在就实现？答案是不需要，但是这个方案应该是可以扩展的，以后经过10年也是可以胜任的。前段时间碰到一个BI的问题，简单地说，就是管道不够粗。做PD的人，看到网站订单越来越多，会很开心，但是BI的数据管道要越来越宽畅才能承受。以前的管道只有这么粗就够了，但是现在订单已经放大了两倍、三倍，但是管道对于这个数据量已经太小，塞不进去了。这么多的数据在一天内同步不完，就导致很多报表出不来，很多PD就开始问，为什么我要的报表出不来？其实问题的背后是架构的问题。首先是架构的本身有问题；其次还有一个增量同步的问题。这个问题两年以前就提出来了，解决方案也有，但是PD这边推进还是不够快。增量和全量的差别还是很大的，1000倍都不止，本来是要同步1000个东西，但是有增量的话，只要同步一个东西就行。如果有增量的话原来的管道就已经是够粗的了。这个问题出现了，我们也有一些解决方案，但是这些解决方案没有走在问题的前面。这个问题解决掉，可以提升1000倍而不是1倍，后面的管道就不需要那么粗。管道打粗也是有开销的，本来1台数据库就可以了，但是如果没有增量，为了要1000倍的数据的量能扛得住，需要5台的数据库，后面的管道要打的很宽。从架构的角度来讲，是资源的浪费，有增量的话，长期的解决方案就有了。
架构师要看到一个问题应该要很兴奋，因为你看到的问题越多，解决的问题越多，那你的经验就会越丰富，成长的就越快。
关于合格的架构师今天我要分享的就这些，最后要提到一点，虽然和今天的演讲关系不大，但是我觉得架构师们应该去思考，如果你自己给自己定了一个目标，三个月以后来验收你的成绩，应该怎么衡量？
有5点大家可以参考：
减少因架构引起的RCA数量
发现目前系统中的架构中缺陷
提出的方案要能解决现有问题
提出高质量的架构设计，并且其他人会采纳，能落地
展示你的领导能力并成为大家愿意学习的榜样。。